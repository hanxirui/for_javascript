<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.riil.base.policy.impl.dao.PolicyScriptMetricDAO">

	<resultMap type="com.riil.base.resmodel.pojo.policy.PolicyScriptMetricPojo" id="PolicyScriptMetricResultMap">
		<result property="id" column="C_ID" javaType="string" jdbcType="VARCHAR" />
		<result property="companyId" column="C_COMPANY_ID" javaType="string" jdbcType="VARCHAR" />
		<result property="policyId" column="C_POLICY_ID" javaType="string" jdbcType="VARCHAR" />
		<result property="metricId" column="C_METRIC_ID" javaType="string" jdbcType="VARCHAR" />
		<result property="metricName" column="C_METRIC_NAME" javaType="string" jdbcType="VARCHAR" />
		<result property="metricNameEn" column="C_METRIC_NAME_EN" javaType="string" jdbcType="VARCHAR" />
		<result property="dataType" column="C_DATA_TYPE" javaType="string" jdbcType="VARCHAR" />
		<result property="columnId" column="C_COLUMN_ID" javaType="_int" jdbcType="SMALLINT" />
		<result property="rowId" column="C_ROW_ID" javaType="_int" jdbcType="SMALLINT" />
	</resultMap>



	<!-- Insert POJO object -->
	<insert id="insert" parameterType="java.util.Map">
		INSERT INTO t_moni_policy_script_metric ( C_ID, C_COMPANY_ID,
		C_POLICY_ID, C_METRIC_ID, C_METRIC_NAME,
		C_METRIC_NAME_EN,
		C_DATA_TYPE, C_COLUMN_ID, C_ROW_ID)
		VALUES
			( #{id, jdbcType=VARCHAR},
			#{companyId, jdbcType=VARCHAR}, #{policyId ,jdbcType=VARCHAR},
			#{metricId, jdbcType=VARCHAR},
			#{metricName, jdbcType=VARCHAR},
			#{metricNameEn, jdbcType=VARCHAR} , #{dataType, jdbcType=VARCHAR},
			#{columnId, jdbcType=SMALLINT}, #{rowId, jdbcType=SMALLINT} )
	</insert>
	<insert id="batchInsert" parameterType="java.util.Map">
		INSERT INTO t_moni_policy_script_metric ( C_ID, C_COMPANY_ID,
		C_POLICY_ID, C_METRIC_ID, C_METRIC_NAME,
		C_METRIC_NAME_EN,
		C_DATA_TYPE, C_COLUMN_ID, C_ROW_ID)
		VALUES
		<foreach collection="scriptMetrics" item="scriptMetric" separator=",">
			( #{scriptMetric.id},
			#{scriptMetric.companyId}, #{policyId ,jdbcType=VARCHAR},
			#{scriptMetric.metricId},
			#{scriptMetric.metricName},
			#{scriptMetric.metricNameEn} , #{scriptMetric.dataType},
			#{scriptMetric.columnId}, #{scriptMetric.rowId} )
        </foreach>
	</insert>

	<delete id="delete_by_policyId" parameterType="string">
		delete from t_moni_policy_script_metric where C_POLICY_ID =
		#{policyId ,jdbcType=VARCHAR}
	</delete>
	<delete id="delete_by_policyIds" parameterType="list">
		delete from t_moni_policy_script_metric where C_POLICY_ID  IN
		<foreach item="policyId" index="index" collection="list" open="(" separator="," close=")">
			#{policyId ,jdbcType=VARCHAR}
	    </foreach>
	</delete>
	<select id="select_script_metric_by_policyId" parameterType="string" resultMap="PolicyScriptMetricResultMap">
		SELECT C_COMPANY_ID,
		C_POLICY_ID, C_METRIC_ID, C_METRIC_NAME,
		C_METRIC_NAME_EN,
		C_DATA_TYPE, C_COLUMN_ID, C_ROW_ID
		FROM
		t_moni_policy_script_metric
		WHERE C_POLICY_ID = #{policyId ,jdbcType=VARCHAR}
    </select>

	<select id="select_script_metric_by_resId" parameterType="string" resultMap="PolicyScriptMetricResultMap">
		SELECT m.C_ID, m.C_COMPANY_ID,
		m.C_POLICY_ID, m.C_METRIC_ID,
		m.C_METRIC_NAME, m.C_METRIC_NAME_EN,
		m.C_DATA_TYPE, m.C_COLUMN_ID, m.C_ROW_ID
		FROM
		t_moni_policy_script_metric m, t_moni_policy_script_res r
		WHERE m.C_POLICY_ID = r.C_POLICY_ID and r.C_ID=#{resId}
	</select>
	<!-- Update POJO object policyId by oriPolicyId -->
	<update id="update_newPolicyId_by_oriPolicyId" parameterType="java.util.Map">
		UPDATE t_moni_policy_script_metric
		SET C_POLICY_ID =	#{oriPolicyId}
		WHERE C_POLICY_ID = #{newPolicyId}
    </update>
</mapper>
